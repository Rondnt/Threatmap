import api from './api';

export const vulnerabilityService = {
  // Obtener todas las vulnerabilidades
  getAll: (params = {}) => {
    return api.get('/vulnerabilities', { params });
  },

  // Obtener vulnerabilidad por ID
  getById: (id) => {
    return api.get(`/vulnerabilities/${id}`);
  },

  // Crear nueva vulnerabilidad
  create: (data) => {
    return api.post('/vulnerabilities', data);
  },

  // Actualizar vulnerabilidad
  update: (id, data) => {
    return api.put(`/vulnerabilities/${id}`, data);
  },

  // Eliminar vulnerabilidad
  delete: (id) => {
    return api.delete(`/vulnerabilities/${id}`);
  },

  // Obtener estadÃ­sticas
  getStatistics: () => {
    return api.get('/vulnerabilities/statistics');
  },

  // Asociar amenaza a vulnerabilidad
  associateThreat: (id, threatId) => {
    return api.post(`/vulnerabilities/${id}/threats`, { threat_id: threatId });
  }
};
